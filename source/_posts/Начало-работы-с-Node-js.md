---
title: Начало работы с Node.js
tags: учебный проект
date: 2018-09-14 03:24:22
---


<p>
    Работа у меня не связана с бекендом. Но в начале своего пути программиста я хотел стать "бекендщиком", имея немного опыта работы с PHP и написания серверного кода, руки чесались попробовать написать что то подобное на JavaScript'e. 
</p>
<p>
    И так у нас есть нода. Ввиду того что это домашний учебный проект. Мы можем обойтись самым минимальным набором, что бы дальше эксперементировать. Есть определенный список/роадмап(может быть выложу позже), который есть у меня в голове, технологий которые я хочу освоить в близжайшее время и это будет серия домашних проектов которые помогут мне понять хотя бы основы той или иной технологии и понять, то куда я хочу двигаться. 
</p>
<p>
    Начнем с бекенда. Цель текущего проекта: описать REST сервер который будет общаться с БД(mysql, postgresql), отдавать данные в нескольких форматах. Будет легко расширяемым и удобным в разработке. 
</p>
<h5>
    Что в ожидаеться увидеть в итоге: 
</h5>
<ul>
    <li>В основе серверва будет лежать MVC архетектура.</li>
    <li>будем использовать TypeScript</li>
    <li>Код будет покрываться unit тестами</li>
    <li>IoC & DI</li>
    <li>Error Handling</li>
    <li>Система логирования</li>
    <li>ORM</li>
    <li>HATEOAS (Hypermedia as the Engine of Application State)</li>
    <li>CLI</li>
    <li>JWT</li>
</ul>

<p>
    Во первых. Я провел довольно много времени пытаясь выяснить как в основном люди пишут сервисы на ноде и...тут меня ждал сюрприз. Экосистема ноды довольно молодая, напоминает PHP времени когда фреймворки были редкостью и каждый писал своё решение под себя. Примерно это я увидел и тут. Конечно есть Express, Koa но они довольно минималистичны и не дают понятия как строить свое приложение. Поэтому ввиду того что это учебный проект я взял за основу Express и решил написать обычный MVC.
</p>

<p>
    MVC - архетектурный паттерн. То есть то как у нас строится приложение. В основе лежит идея. Когда есть три независимых чатси проекта

    M - model - модель данных. Это часть проекта которая отвечает за получение данных. Как пример: у нас есть База Данных из которой мы можем получить данные. Код который будет отвечать за получение каких то нужных нам данных из БД и есть модель

    V - view - это представление, код который как либо отдает данные во вне. То есть он получает данные и может преобразовав в нужный нам формат отправить их. То есть это может быть html, json, xml, шаблон какого то шаблонизатора. Тога view подставляет данные в шаблон и отдаёт страницу.

    С - сontroller - это обьект который управляет всем этим бардаком. То есть, когда к нам приходит запрос, он приходит в контроллер, который в свою очередь берет данные из модели, перерабатывает данные реализуя бизнес логику и передаёт результат в view.

</p>
<p>
    Обычно Controller'ы не имеют сильно много логики. Роль блоков логики выполняют services. Сервисы - это обьекты которые представляют слой где располагается логика нашего приложения, которая решает какую то, конкретную, задачу. Тем самым взяв данные из модели и выполнив нужные нам действия с помошью сервисов. Мы получаем результат который отправляется во view и он отправляется ответом пользователю.
</p>
<p>
    Но как запрос попадёт к контроллеру ? Для этого существует Обьект Router он получает запрос, на основе него делает вывод какой контроллер вызывать. В свою очередь контроллер идет к модели за данными, преобразовывает данные для ответа в соотвествии с бизнес логикой и отдаёт во вью.
</p>
<p>
    Во вторых. JS имеет динамическую типизацию и он слабо типизирован. Из-за этого возникают ошибки и проблемы, поэтому было решено приметь TypeScript - это язык который компилируется в JS. Он добавляет типизацию, модификаторы доступа и прочие плюшки ООП. TypeScript очень популярен и на данный момент выбор пал на него, потому что он может пригодиться в дальнейшем в комерческой разработке. Его брат Flow в вопросе типизации гораздо интересней. Тем что он гораздо лучше выводит типы. Но он требует больше ресусов и гораздо дольше компилируется. Но плюсы Flow что он не является отдельным языком. А является просто надстройкой над JS.
</p>
<p>
    В третьих, Unit Tests - один из важных пунктов разработки. Конечно же не всегда в комерческой разработке мы их пишем. Но хорошо написаные тесты уберегают на от ошибок и позволяют, в случае возникновения проблемы, локализовать её. Но только в случае не устаревших и правильно написаных тестов.
</p>

<h6>IoC & DI:</h6>
<p>
    IoC - inversion of control - это подход когда, для того что бы не плодить жесткие связи между двумя блоками, вы разрываете связь передавая часть кода в тот блок с которым он связан и выполняя его там. Как пример, библиотека. Вы подключаете её, испльзуете её методы в вашем коде. Появляется жесткая связь ваш код - бибилиотека. В большей части фреймворков. Вы описываете код, фреймворк берет ваш код, выполняет и отдает вам результат. Как пример Vue.js - там используется компонентный подход. Вы описываете компоненты, с своей логикой. потом отдаёте их Vue и он с помошью "магии" делает двойное связывание и рендер ваших компонентов в дом дереве.
</p>
<p>
    DI -  Dependency Injection - второй подход который позволяет не плодить сущности. Как пример в MVC у нас есть модели. Если мы используем одни и те же данные в разных местах. Мы создаем разные обьекты данных модели и получаемданные. Что является не очень хорошей практикой, так как требует больше памяти и плодит лишние сущности обьектов. Поэтому нам нужен контейнер где мы создадим все нужные нам обьекты. И будем их просто передавать по ссылке в те части приложения, где нужны эти обьекты.
</p>
<p>
Error Handling - нужна система отлавливания ошибок, что бы наш сервер не упал поймав exception или мы могли записать их в лог что бы разобраться что произошло
</p>
<p>
Система логирования - так же нужна система логирования, которая бы писала что происходит на сервере, при возникновении сбоев это поможет нам быстрее найти причину ошибки.
</p>
<p>
ORM - Это подход представления данных в БД и коде. Мы описываем обьект - модель которая является по сути таблицей в базе данных и описываем методы для обновления, записи, получения, удаления данных.
</p>
<p>
HATEOAS - это подход к построению REST сервера, он описывает то как клиент будет общатся с сервером.
</p>
<p>
CLI - тут хочется иметь консольную утилиту которая могла бы генерировать базовые файлы для приложения. Примеры таких CLI - artisan(Laravel) и Django CLI, а также angular-cli
</p>
<p>
JWT - JSON Web Token - открытый стандарт для создания токенов доступа. Хочется видеть удобную в разработке и поддержке систему для авторизации в приложении.
</p>
<p>
Выше я описал что хотелось бы видеть в итоге и что хочется освоить. Работа уже началась, в целом было описана часть ядра, о чем и расскажу в следующем посте.
</p>
